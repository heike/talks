{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Colors like a Grey Sky Winter\"\nauthor: \"Heike Hofmann\"\ndate: \"`r Sys.Date()`\"\noutput: rmarkdown::html_vignette\nvignette: >\n  %\\VignetteIndexEntry{Vignette Title}\n  %\\VignetteEngine{knitr::rmarkdown}\n  %\\VignetteEncoding{UTF-8}\n---\n\n```{r setup, include = FALSE, message=FALSE}\nknitr::opts_chunk$set(\n  collapse = TRUE,\n  comment = \"#>\"\n)\nlibrary(tidyverse)\n```\n\nGrey Sky Winter is one of Gretchen Albrecht's paintings from 1972 (acrylic on canvas).\n![](https://s3.amazonaws.com/img.aasd.com.au/52775868.jpg)\n\nThe goal is to find a colour palette that captures the colours of this painting to be used in a colour palette. \nThe approach we take here is to take a sample of colour points from the painting, cluster it, and return an object from which we can draw a specified set of colours.\n\nThe `make_palette` command takes a link to a jpeg file and creates a cluster object based on the rgb values of the image. For computational feasibility only a sample of points is taken. By default, this sample is of size 1000, this can be changed by re-setting the value of `limit` in `make_palette`.\n```{r}\nlibrary(gretchenalbrecht)\ngsw <- make_palette(\"https://s3.amazonaws.com/img.aasd.com.au/52775868.jpg\")\ngsw$name <- \"grey sky winter\"\n```\n\nBesides the cluster object, `make_palette` also returns the sampled colours in a data object.\n```{r, echo=FALSE, eval=FALSE}\ngsw$data$colour = with(gsw$data, rgb(red/256, green/256, blue/256))\ngsw$data$id <- 140*(1:nrow(gsw$data) -1)\ngsw$data$x <- gsw$data$id %% 350\ngsw$data$y <- gsw$data$id %/% 350\n\ngsw$data %>% ggplot(aes(x, -y, colour= colour)) + geom_point() +scale_colour_identity() + coord_equal()\n```\n\nFrom the newly created palette we can extract a set number of colours using the command `get_pal(pal, K)`, where `pal` is either the named palette or the palette object, and `K` specifies the number of colours to be extracted. \n\nIn the example below, we are comparing the first 30 palettes to each other. It is interesting that this data driven method of extracting colours for each group results in fairly stable colours that reflect the original painting quite well.\n\n\n```{r}\ncols <- list()\nfor (i in 1:30) {\n  cols[[i]] <- get_pal(i, gsw) \n}\ncols <- cols %>% purrr::map_df(.f = function(x) {\n  x$K = nrow(x)\n  x\n})\ncols %>% \n  ggplot(aes(x = k, y = K)) + \n  geom_tile(aes(fill=col)) + \n  scale_fill_identity() + \n  theme_bw() +\n  ylab(\"Number of colours in palette\")\n```\n\nLet's play the same game with a different painting, e.g. with Gretchen Albrecht's 2012 painting Oceanic:\n\n```{r, message = FALSE}\noc <- make_palette(\"https://artinfo-images-350.s3.amazonaws.com/asi2-130920/175.jpg\")\noc$name <- \"oceanic\"\n```\n```{r, echo = FALSE}\ncols <- list()\nfor (i in 1:30) {\n  cols[[i]] <- get_pal(i, oc) \n}\ncols <- cols %>% purrr::map_df(.f = function(x) {\n  x$K = nrow(x)\n  x\n})\ncols %>% \n  ggplot(aes(x = k, y = K)) + \n  geom_tile(aes(fill=col)) + \n  scale_fill_identity() + \n  theme(legend.position=\"none\") +\n  theme_bw() +\n  ylab(\"Number of colours in palette\")\n```\n![](https://artinfo-images-350.s3.amazonaws.com/asi2-130920/175.jpg)\n\n\nWhile this approach promising, there are a couple of reasons, why we should not use these automatically created colour palettes as out-of-the-box solution, but rather as some suggestions in need of some thoughtful post-processing:\n\nAn obvious drawback of the automatic approach is that each painting has a background colour, which is quite dominant. The background colour generally has not very strong contrast to the either white or grey, the standard backgrounds colours in `ggplot2`, which renders this 'colour' choice to be an 'un-colour'. \n\n\nAnother drawback is that, as each of the colours in the palette, which in turn is based on a clustering method, the colours are inherently un-ordered. However, we perceive shades of the same hue, such as for example the shades of blue in the example below, as ordered. In fact, tests for colour acuity are based on our ability to order colours according to their luminance in different hues.\nWhile similar hues imply similarity of objects, objects with very different hues imply a stark contrast between them, which might not be present in the data. \n\n```{r, message=FALSE}\nsg <- make_palette(\"https://artinfo-images-350.s3.amazonaws.com/asi2-126395/346.jpg\")\nsg$name <- \"soft grey\"\n```\n\n```{r}\ncols6 <- get_pal(6, sg) \n\ncols6 %>% \n  ggplot(aes(x=1, y=1)) + \n  geom_tile(aes(fill=col)) + facet_wrap(~k) +\n  scale_fill_identity() + \n  theme(legend.position=\"none\") +\n  theme_bw() + coord_equal() +\n  theme(axis.title =element_blank(), axis.text=element_blank(),\n        axis.ticks = element_blank()) +\n  geom_text(x=1, y=1, aes(label=col))\n```\n\n\n\n![](https://artinfo-images-350.s3.amazonaws.com/asi2-126395/346.jpg)\n\n\nInternally, the clustering object returns `K` groups. For each group, a single colour is determined as the median of the red, green, and blue values. Using the median or mean does not result in huge differences. \n\n```{r, message = FALSE, fig.width=8, fig.height = 4, fig.cap=\"Data and colours for a palette of size ten based on the painting 'Cataract'. Thin lines correspond to the 1000 data points sampled from the painting, thick lines show colours based on mean and median for each of the ten clusters.\"}\nct <- make_palette(\"https://artinfo-images-350.s3.amazonaws.com/asi2-123709/221.jpg\")\nct$name <- \"cataract\"\nct$data$k <- cutree(ct$clust, 10)\n\ntilesMedian <- ct$data %>% group_by(k) %>% \n  summarize(red=median(red), blue=median(blue), green=median(green)) %>%\n  mutate(col=rgb(red/255, green/255, blue/255)) %>% \n  gather(channel, value, red:green)\n\ntilesMean <- ct$data %>% group_by(k) %>% \n  summarize(red=mean(red), blue=mean(blue), green=mean(green)) %>%\n  mutate(col=rgb(red/255, green/255, blue/255)) %>% \n  gather(channel, value, red:green)\n\ncataract <- ct$data %>% \n  mutate(col=rgb(red/255, green/255, blue/255), id=1:nrow(ct$data)) %>% \n  gather(channel, value, red:green)\n\ncataract %>% ggplot(aes(x = channel, y = value, colour = col)) +\n  theme_bw() + geom_line(aes(group=id), size=0.25, alpha=0.5) + scale_colour_identity() +\n  facet_wrap(~k, ncol=5) + \n  geom_line(group=1, size=2, data = tilesMean) +\n  geom_line(group=1, size=2, data = tilesMedian)\n  \n```\n\n\n\n```{r, echo = FALSE}\ncols1 <- list()\ncols2 <- list()\nfor (i in 1:30) {\n  cols1[[i]] <- get_pal(i, ct, fun=median) \n  cols2[[i]] <- get_pal(i, ct, fun=mean) \n}\ncols1 <- cols1 %>% purrr::map_df(.f = function(x) {\n  x$K = nrow(x)\n  x\n})\ncols2 <- cols2 %>% purrr::map_df(.f = function(x) {\n  x$K = nrow(x)\n  x\n})\ncols1 %>% \n  ggplot(aes(x = k, y = K)) + \n  geom_tile(aes(fill=col)) + \n  scale_fill_identity() + \n  theme(legend.position=\"none\") +\n  theme_bw() +\n  ylab(\"Number of colours in palette\") + ggtitle(\"Colours based on median\")\ncols2 %>% \n  ggplot(aes(x = k, y = K)) + \n  geom_tile(aes(fill=col)) + \n  scale_fill_identity() + \n  theme(legend.position=\"none\") +\n  theme_bw() +\n  ylab(\"Number of colours in palette\") + ggtitle(\"Colours based on mean\")\n```\n\n![](https://artinfo-images-350.s3.amazonaws.com/asi2-123709/221.jpg)\n\n\n## Other paintings\n\n```{r}\ncorona <- make_palette(\"https://media.mutualart.com/Images/2017_06/18/09/094326623/b3695f86-826c-4c5b-9a6a-8c05bc85f815_570.Jpeg\")\nuntitled <- make_palette(\"https://media.mutualart.com/Images/2017_12/07/06/064446678/f2daa4f7-448c-4aeb-b486-e4e9c9985b85_570.Jpeg\")\n\n\ncols6 <- get_pal(8, untitled) \n\ncols6 %>% \n  ggplot(aes(x=1, y=1)) + \n  geom_tile(aes(fill=col)) + facet_wrap(~k, ncol=4) +\n  scale_fill_identity() + \n  theme(legend.position=\"none\") +\n  theme_bw() + coord_equal() +\n  theme(axis.title =element_blank(), axis.text=element_blank(),\n        axis.ticks = element_blank()) +\n  geom_text(x=1, y=1, aes(label=col))\n\n```\n\n![](https://media.mutualart.com/Images/2017_06/18/09/094326623/b3695f86-826c-4c5b-9a6a-8c05bc85f815_570.Jpeg)\n\n![](https://media.mutualart.com/Images/2017_12/07/06/064446678/f2daa4f7-448c-4aeb-b486-e4e9c9985b85_570.Jpeg)\n\n\n\n## Colors like csafe\n\n```{r, fig.width=4, fig.height=4}\ncsafe <- make_palette(\"/Users/heike/CSAFE/CSAFE Logo.png\")\ncols10 <- get_pal(11, csafe) \n\ndframe <- data.frame(x = rnorm(1000), y = rnorm(1000), col=sample(1:10, 1000, replace=TRUE))\ndframe %>% ggplot(aes(x = x, y=y, colour=factor(col))) + geom_point(size=3) + \n  theme_bw() +\n  theme(legend.position=\"none\") +\n  scale_colour_manual(values=cols10$col[-1])\n```",
    "created" : 1518372952822.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "682619922",
    "id" : "9DA7EF06",
    "lastKnownWriteTime" : 1516201041,
    "last_content_update" : 1516201041,
    "path" : "~/packages/gretchenalbrecht/vignettes/palettes.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}